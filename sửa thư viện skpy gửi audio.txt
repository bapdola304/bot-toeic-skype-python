    def sendFile(self, content, name, image=False, audio=False):
        """
        Upload a file to the conversation.  Content should be an ASCII or binary file-like object.

        If an image, Skype will generate a thumbnail and link to the full image.

        Args:
            content (file): file-like object to retrieve the attachment's body
            name (str): filename displayed to other clients
            image (bool): whether to treat the file as an image

        Returns:
            .SkypeFileMsg: copy of the sent message object
        """
        meta = {"type": "pish/image" if image else "sharing/audio" if audio else "sharing/file",
                "permissions": dict(("8:{0}".format(id), ["read"]) for id in self.userIds)}
        if not image:
            meta["filename"] = name
        objId = self.skype.conn("POST", "https://api.asm.skype.com/v1/objects",
                                auth=SkypeConnection.Auth.Authorize,
                                headers={"X-Client-Version": "0/0.0.0.0"},
                                json=meta).json()["id"]
        objType = "imgpsh" if image else "audio" if audio else "original"
        urlFull = "https://api.asm.skype.com/v1/objects/{0}".format(objId)
        self.skype.conn("PUT", "{0}/content/{1}".format(urlFull, objType),
                        auth=SkypeConnection.Auth.Authorize, data=content.read())
        size = content.tell()
        if image:
            viewLink = SkypeMsg.link("https://api.asm.skype.com/s/i?{0}".format(objId))
            body = SkypeMsg.uriObject("""{0}<meta type="photo" originalName="{1}"/>""".format(viewLink, name),
                                      "Picture.1", urlFull, thumb="{0}/views/imgt1".format(urlFull), OriginalName=name)
        elif audio:
            viewLink = SkypeMsg.link("https://login.skype.com/login/sso?go=xmmfallback?am={0}".format(objId))
            body = '<URIObject uri="https://api.asm.skype.com/v1/objects/{0}" url_thumbnail="https://api.asm.skype.com/v1/objects/{0}/views/audio" type="Audio.1" doc_id="{0}">Để nghe tệp âm thanh này, hãy truy cập: <a href="https://login.skype.com/login/sso?go=webclient.xmm&amp;docid={0}">https://login.skype.com/login/sso?go=webclient.xmm&amp;docid={0}</a><OriginalName v="{1}"></OriginalName><FileSize v="{2}"></FileSize></URIObject>'.format(objId, name, size)
        else:
            viewLink = SkypeMsg.link("https://login.skype.com/login/sso?go=webclient.xmm&docid={0}".format(objId))
            body = SkypeMsg.uriObject(viewLink, "File.1", urlFull, "{0}/views/thumbnail".format(urlFull), name, name,
                                      OriginalName=name, FileSize=size)
        msgType = "RichText/{0}".format("UriObject" if image else "Media_GenericFile")
        return self.sendRaw(content=body, messagetype=msgType)